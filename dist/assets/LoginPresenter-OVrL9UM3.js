class s{constructor(i,e){this.model=i,this.view=e}init(){this.setupTabs(),this.setupForms()}setupTabs(){const i=document.getElementById("login-tab"),e=document.getElementById("register-tab");i.addEventListener("click",()=>{this.view.switchToLoginMode(),this.view.clearValidationErrors("login"),this.view.clearValidationErrors("register")}),e.addEventListener("click",()=>{this.view.switchToRegisterMode(),this.view.clearValidationErrors("login"),this.view.clearValidationErrors("register")})}setupForms(){const i=document.getElementById("login-form"),e=document.getElementById("register-form");i.addEventListener("submit",async t=>{t.preventDefault(),await this.handleLogin()}),e.addEventListener("submit",async t=>{t.preventDefault(),await this.handleRegister()})}async handleLogin(){this.view.clearValidationErrors("login");const i=this.view.getFormData("login"),e={email:i.get("email"),password:i.get("password")};if(this.model.validateCredentials(e).length>0){(!e.email||!e.email.includes("@"))&&this.view.showValidationError("login","email","Valid email is required"),(!e.password||e.password.length<6)&&this.view.showValidationError("login","password","Password must be at least 6 characters long");return}try{window.app.showLoading(),await this.model.login(e),alert("Login successful!"),window.app.updateNavigation(),window.location.hash="#home"}catch(r){console.error("Login error:",r),this.view.showFormError("login",r.message||"Login failed. Please try again.")}finally{window.app.hideLoading()}}async handleRegister(){this.view.clearValidationErrors("register");const i=this.view.getFormData("register"),e={name:i.get("name"),email:i.get("email"),password:i.get("password")};if(this.model.validateRegistrationData(e).length>0){(!e.name||e.name.trim().length<2)&&this.view.showValidationError("register","name","Name must be at least 2 characters long"),(!e.email||!e.email.includes("@"))&&this.view.showValidationError("register","email","Valid email is required"),(!e.password||e.password.length<6)&&this.view.showValidationError("register","password","Password must be at least 6 characters long");return}try{window.app.showLoading(),await this.model.register(e),alert("Registration successful! Please login with your credentials."),this.view.switchToLoginMode(),this.view.fillLoginCredentials(e.email,e.password)}catch(r){console.error("Registration error:",r),this.view.showFormError("register",r.message||"Registration failed. Please try again.")}finally{window.app.hideLoading()}}}export{s as LoginPresenter};
